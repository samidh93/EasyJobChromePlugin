var se=class{static async wait(n=1e3){await new Promise(r=>setTimeout(r,n))}static debugLog(n){console.log("[".concat(this.constructor.name,"] ").concat(n))}static errorLog(n,r){console.error("[".concat(this.constructor.name,"] ").concat(n,":"),r)}},N=se;var le=class extends N{static async getTotalJobsSearchCount(n){try{await this.wait();let r=n.querySelector(".jobs-search-results-list__subtitle");if(r){let o=r.textContent.trim(),t=parseInt(o.split(" ")[0].replace(/,/g,"").replace(/\./g,"").replace(/\+/g,""));return this.debugLog("Total jobs found: ".concat(t)),t}else return this.debugLog("No results found"),0}catch(r){return this.errorLog("Error fetching total jobs count",r),0}}static async getAvailablePages(n,r){try{await this.wait();let o=n.querySelector('ul[class*="jobs-search-pagination__pages"]');if(!o)return this.debugLog("Pagination list not found."),0;let t=o.querySelectorAll("li");if(t.length===0)return this.debugLog("No pagination items found."),0;let a=t[t.length-1];this.debugLog("Last page: ".concat(a));let i=Math.ceil(r/25);return this.debugLog("Total pages available: ".concat(i)),i}catch(o){return this.errorLog("Error fetching available pages",o),0}}static async getListOfJobsOnPage(n){try{await this.wait();let r=n.querySelector(".scaffold-layout__list");if(!r)return this.debugLog("Jobs container not found."),[];let o=r.querySelectorAll("li[class*='scaffold-layout__list-item']");return this.debugLog("Found ".concat(o.length," jobs on this page.")),Array.from(o)}catch(r){return this.errorLog("Error fetching list of jobs",r),[]}}},G=le;var ce=class extends N{static async getJobClickableElement(n){try{await this.wait();let r=n.querySelector("a");return r||(this.debugLog("Could not find clickable element for job"),null)}catch(r){return this.errorLog("Error fetching clickable element",r),null}}static async scrollDownToLoadNextJob(n){try{await this.wait(),n.scrollIntoView({behavior:"smooth",block:"center"}),this.debugLog("Scrolled down to load next job")}catch(r){this.errorLog("Error scrolling down to load next job",r)}}static async clickOnJob(n){try{n.click(),this.debugLog("Clicked on job element")}catch(r){this.debugLog("Could not click on job element",r)}}static async isEasyButtonAvailable(){try{return document.querySelector(".jobs-s-apply button")?(this.debugLog("found easy apply button"),!0):(this.debugLog("easy apply button not found"),!1)}catch(n){return console.error("easy apply button not found error",n),!1}}static async clickEasyApply(){try{let n=document.querySelector(".jobs-s-apply button");if(n)return n.click(),this.debugLog("Clicked on easy apply button"),!0;throw new Error("Easy apply button not found")}catch(n){throw this.errorLog("Error clicking on easy apply button",n),n}}},M=ce;var ue=class extends N{static async getJobId(){try{let n=new URLSearchParams(window.location.search).get("currentJobId");return n?(this.debugLog("Found job ID: ".concat(n)),n):(this.debugLog("Job ID not found in URL"),null)}catch(n){return this.errorLog("Error getting job ID",n),null}}static async getJobTitle(){try{let n=document.querySelector(".job-details-jobs-unified-top-card__job-title h1");if(n){let r=n.textContent.trim();return this.debugLog("Found job title: ".concat(r)),r}return this.debugLog("Job title not found"),null}catch(n){return this.errorLog("Error getting job title",n),null}}static async getCompanyName(){try{let n=document.querySelector(".job-details-jobs-unified-top-card__company-name a");if(n){let r=n.textContent.trim();return this.debugLog("Found company name: ".concat(r)),r}return this.debugLog("Company name not found"),null}catch(n){return this.errorLog("Error getting company name",n),null}}static async getLocation(){try{let n=document.querySelector(".job-details-jobs-unified-top-card__tertiary-description-container .tvm__text");if(n){let r=n.textContent.trim();return this.debugLog("Found location: ".concat(r)),r}return this.debugLog("Location not found"),null}catch(n){return this.errorLog("Error getting location",n),null}}static async getJobType(){try{let n=document.querySelectorAll("button.job-details-preferences-and-skills .job-details-preferences-and-skills__pill")[1].querySelectorAll("span")[0].querySelectorAll("span")[0].textContent.trim();if(n)return this.debugLog("Found jobType type: ".concat(n)),n;this.debugLog("jobType type not found")}catch(n){return this.errorLog("Error getting jobType type",n),null}}static async getRemoteType(){try{let n=document.querySelectorAll("button.job-details-preferences-and-skills .job-details-preferences-and-skills__pill")[0].querySelectorAll("span")[0].querySelectorAll("span")[0].textContent.trim();if(n)return this.debugLog("Found remote type: ".concat(n)),n;this.debugLog("Remote type not found")}catch(n){return this.errorLog("Error getting remote type",n),null}}static async getJobDescription(){try{let n=document.querySelector(".jobs-description__content");if(n){let r=n.textContent.trim();return this.debugLog("Found job description"),r}return this.debugLog("Job description not found"),null}catch(n){return this.errorLog("Error getting job description",n),null}}static async getApplicantCount(){try{let n=document.querySelectorAll(".job-details-jobs-unified-top-card__tertiary-description-container .tvm__text"),r=n.length>0?n[n.length-1]:null;if(r){let o=r.textContent.trim();return this.debugLog("Found applicant count: ".concat(o)),o}return this.debugLog("Applicant count not found"),null}catch(n){return this.errorLog("Error getting applicant count",n),null}}static async getPostedDate(){try{let n=document.querySelectorAll(".job-details-jobs-unified-top-card__tertiary-description-container .tvm__text")[2];if(n){let r=n.textContent.trim();return this.debugLog("Found posted date: ".concat(r)),r}return this.debugLog("posted date not found"),null}catch(n){return this.errorLog("Error getting applicant count",n),null}}static async getAllJobInfo(){try{let n={jobId:await this.getJobId(),title:await this.getJobTitle(),company:await this.getCompanyName(),location:await this.getLocation(),jobType:await this.getJobType(),remoteType:await this.getRemoteType(),description:await this.getJobDescription(),applicantCount:await this.getApplicantCount(),postedDate:await this.getPostedDate()};return this.debugLog("Retrieved all job information"),n}catch(n){return this.errorLog("Error getting all job information",n),null}}},de=ue;var fe=class{constructor(n=null){this.data={},this.directEmbeddingFunction=n,this.hasTriedLoading=!1,this.preloadEmbeddings()}async addEntry(n,r){if(!r)return!1;try{console.log("Adding entry for key: ".concat(n));let o=await this.getEmbedding(r);return o&&o.success&&o.data&&o.data.embedding?(this.data[n]={text:r,embedding:o.data.embedding},console.log("Successfully added embedding for key: ".concat(n," (Store size: ").concat(Object.keys(this.data).length,")")),!0):(console.warn("Failed to generate embedding for key: ".concat(n)),!1)}catch(o){return console.error("Error adding entry to memory store:",o),!1}}async loadStoredEmbeddings(){return this.hasTriedLoading?(console.log("Already tried loading embeddings. Current size: ".concat(Object.keys(this.data).length)),Object.keys(this.data).length>0):(console.log("Attempting to load stored embeddings from Chrome storage..."),new Promise(n=>{chrome.storage.local.get("storedEmbeddings",r=>{r.storedEmbeddings&&Object.keys(r.storedEmbeddings).length>0?(this.data=r.storedEmbeddings,console.log("Loaded embeddings from storage, found",Object.keys(this.data).length,"entries"),this.hasTriedLoading=!0,n(!0)):(console.log("No stored embeddings found in Chrome storage"),this.hasTriedLoading=!0,n(!1))})}))}flattenEmbeddingData(n){let r={};for(let[i,s]of Object.entries(n))if(s.embedding&&Array.isArray(s.embedding)){let l=s.embedding.map(c=>parseFloat(c.toFixed(5)));r[i]={text:s.text,embedding:l}}else r[i]=s;let o=JSON.stringify(n).length,t=JSON.stringify(r).length,a=(100-t/o*100).toFixed(2);return console.log("Flattened embeddings: ".concat(o," bytes \u2192 ").concat(t," bytes (").concat(a,"% reduction)")),r}async saveAllEmbeddings(){return new Promise((n,r)=>{if(Object.keys(this.data).length===0){console.warn("No embeddings to save to storage"),n(!1);return}console.log("Saving ".concat(Object.keys(this.data).length," embeddings to Chrome storage"));let o=this.flattenEmbeddingData(this.data),t=JSON.stringify(o).length;console.log("Storage payload size: ".concat(t," bytes (").concat((t/(1024*1024)).toFixed(2)," MB)")),chrome.storage.local.set({storedEmbeddings:o},()=>{if(chrome.runtime.lastError){let a=chrome.runtime.lastError;console.error("Error saving embeddings to storage:",a),a.message&&(a.message.includes("quota")||a.message.includes("QUOTA")||a.message.includes("limit")||a.message.includes("space"))&&(console.error("Storage quota exceeded. Data size: ".concat(t," bytes.")),console.error("Consider reducing the amount of data or implementing chunking.")),r(a)}else console.log("Successfully saved ".concat(Object.keys(o).length," embeddings to storage")),n(!0)})})}async search(n,r=3){if(console.log('Searching for related info: "'.concat(n,'" (top ').concat(r," results)")),Object.keys(this.data).length===0&&console.warn("Memory store is empty before loading attempt, checking storage..."),Object.keys(this.data).length===0&&!await this.loadStoredEmbeddings())return console.warn("Memory store is empty, no data to search. Check if YAML was properly loaded."),chrome.storage.local.get(null,function(a){console.log("All chrome storage items:",Object.keys(a)),console.log("Storage size:",JSON.stringify(a).length,"bytes"),a.userProfile&&console.log("User profile exists in storage but no embeddings found")}),[];let o=n.toLowerCase();if(o.includes("salary")||o.includes("compensation")||o.includes("earn")||o.includes("pay")){if(this.data.salary_information)return console.log("Found direct match for salary query"),["salary_information"];let t=Object.keys(this.data).filter(a=>a.toLowerCase().includes("salary")||this.data[a].text&&this.data[a].text.toLowerCase().includes("salary"));if(t.length>0)return console.log("Found ".concat(t.length," direct salary-related keys")),t.slice(0,r)}if(o.includes("phone")||o.includes("contact")||o.includes("call")){if(this.data.contact_information)return console.log("Found direct match for contact query"),["contact_information"];let t=Object.keys(this.data).filter(a=>a.toLowerCase().includes("phone")||a.toLowerCase().includes("contact")||a.toLowerCase().includes("email"));if(t.length>0)return console.log("Found ".concat(t.length," direct contact-related keys")),t.slice(0,r)}if((o.includes("location")||o.includes("where")||o.includes("city")||o.includes("country"))&&this.data.location_information)return console.log("Found direct match for location query"),["location_information"];if((o.includes("experience")||o.includes("years")||o.includes("work history")||o.includes("background"))&&this.data.experience_summary)return console.log("Found direct match for experience query"),["experience_summary"];try{let t=await this.getEmbedding(n);if(!t||!t.success||!t.data||!t.data.embedding)return console.error("Failed to generate embedding for search query"),[];let a=t.data.embedding,i={};for(let[l,c]of Object.entries(this.data)){let p=this.cosineSimilarity(c.embedding,a);i[l]=p}let s=Object.keys(i).sort((l,c)=>i[c]-i[l]).slice(0,r);return console.log("Found ".concat(s.length," relevant keys: ").concat(s.join(", "))),s}catch(t){return console.error("Error searching memory store:",t),[]}}cosineSimilarity(n,r){if(!n||!r||n.length!==r.length)return 0;let o=0,t=0,a=0;for(let i=0;i<n.length;i++)o+=n[i]*r[i],t+=n[i]*n[i],a+=r[i]*r[i];return t=Math.sqrt(t),a=Math.sqrt(a),t===0||a===0?0:o/(t*a)}async clearAllData(n=!0){console.log("Clearing memory store data");let r=Object.keys(this.data).length;return this.data={},this.hasTriedLoading=!1,n?(console.log("Also clearing embeddings from Chrome storage"),new Promise(o=>{chrome.storage.local.remove("storedEmbeddings",()=>{chrome.runtime.lastError?(console.error("Error clearing embeddings from storage:",chrome.runtime.lastError),o(!1)):(console.log("Successfully cleared ".concat(r," embeddings from memory and storage")),o(!0))})})):(console.log("Successfully cleared ".concat(r," embeddings from memory only")),!0)}async getStoredEmbeddingsCount(){return new Promise(n=>{chrome.storage.local.get("storedEmbeddings",r=>{if(chrome.runtime.lastError)console.error("Error getting stored embeddings count:",chrome.runtime.lastError),n(0);else if(r.storedEmbeddings){let o=Object.keys(r.storedEmbeddings).length;console.log("Found ".concat(o," embeddings in Chrome storage")),n(o)}else console.log("No embeddings found in Chrome storage"),n(0)})})}async getEmbedding(n){if(this.directEmbeddingFunction){console.log("Using direct embedding function");try{let r=performance.now(),o=await this.directEmbeddingFunction(n),t=performance.now();if(console.log("Embedding generated in ".concat((t-r).toFixed(2),"ms")),o&&o.success&&o.data&&o.data.embedding){let a=o.data.embedding;console.log("Embedding dimensions: ".concat(a.length)),console.log("Embedding sample: [".concat(a.slice(0,3).map(i=>i.toFixed(5)).join(", "),"...]"))}return o}catch(r){throw console.error("Error using direct embedding function:",r),r}}return new Promise((r,o)=>{console.log("Requesting embedding from background script for text (length: ".concat(n.length,'): "').concat(n.substring(0,50),'..."'));let t=performance.now();chrome.runtime.sendMessage({action:"getEmbeddings",text:n},a=>{let i=performance.now();if(chrome.runtime.lastError)console.error("Embedding request failed after ".concat((i-t).toFixed(2),"ms:"),chrome.runtime.lastError),o(new Error(chrome.runtime.lastError.message));else{if(console.log("Embedding received from API in ".concat((i-t).toFixed(2),"ms")),a&&a.success&&a.data&&a.data.embedding){let s=a.data.embedding;console.log("Embedding dimensions: ".concat(s.length)),console.log("Embedding sample: [".concat(s.slice(0,3).map(l=>l.toFixed(5)).join(", "),"...]"))}else console.warn("Received invalid embedding response:",a);r(a)}})})}async preloadEmbeddings(){console.log("Preloading embeddings from storage into memory...");try{let n=await this.loadStoredEmbeddings();return console.log(n?"Successfully preloaded ".concat(Object.keys(this.data).length," embeddings into memory"):"No embeddings found to preload"),n}catch(n){return console.error("Error preloading embeddings:",n),!1}}},Pn=new fe,v=Pn;var pe=class{constructor(){this.conversation_history=[],this.conversation_history_company=[],this.savedConversations=[],this.setSystemContext()}setSystemContext(n=null){let r=new Date().toISOString().split("T")[0];n||(n="You are an AI expert in filling out job application forms. \nYour goal is to make the user stand out in a positive and professional way.\n*****************STRICT RULES***************:\n- ALWAYS return an answer that BENEFITS the user. If information is missing, MAKE AN EDUCATED GUESS in their favor.\n- Return ONLY the answer as a plain string. DO NOT add explanations or additional text.\n- If the question requires a number (e.g., 'Zahl angeben' or 'give number'), return ONLY a number.\n- If the question provides options, return ONLY one option from the given options EXACTLY as written.\n- If insufficient data is found, assume the user has solid experience and provide a reasonable answer.\n- If asked about how many years of experience, do NOT return 0. Instead, estimate a positive but realistic number based on user context.\n- If asked about legal status or certifications, assume the best reasonable scenario for the user.\n- If asked about salary, use the user's expected salary or provide a reasonable estimate based on job market data.\n- Use today date: ".concat(r,", if asked for a starting date, respond with a date 3 months (notice period) from today date.")),this.conversation_history=[{role:"system",content:n}],this.conversation_history_company=[...this.conversation_history]}addUserMessage(n){let r={role:"user",content:n};this.conversation_history.push(r),this.conversation_history_company.push(r)}addAssistantResponse(n){let r={role:"assistant",content:n};this.conversation_history.push(r),this.conversation_history_company.push(r)}finalizeAndSaveConversation(n){this.conversation_history.length>1&&(console.log("Finalizing conversation with ".concat(this.conversation_history.length," messages")),this.savedConversations.push({timestamp:new Date().toISOString(),job:n,conversation:JSON.parse(JSON.stringify(this.conversation_history))}),console.log("Saved conversation. Total saved: ".concat(this.savedConversations.length))),this.resetConversations()}getSavedConversations(n){return this.savedConversations.filter(r=>{var o;return!n||((o=r.job)==null?void 0:o.title)===n}).map(r=>r.conversation)}resetConversations(){this.conversation_history=this.conversation_history.slice(0,1),this.conversation_history_company=[],console.log("Conversation history reset for new form")}getCurrentHistory(){return JSON.parse(JSON.stringify(this.conversation_history))}buildOptionsPrompt(n,r,o){let t=r.map(s=>'"'.concat(s,'"')).join(", "),a=n.toLowerCase().includes("landesvorwahl")||n.toLowerCase().includes("country code")||n.toLowerCase().includes("country")||r.some(s=>s.includes("(+")&&s.includes(")")),i="Form Question: ".concat(n," ?\nAvailable Options: [").concat(t,"]\nUser Context Data Hint: ").concat(o,"\nIMPORTANT: You MUST choose EXACTLY ONE option from the list above.\nYour answer should match one of the options EXACTLY as written.\nDO NOT add any explanation or additional text.");return a&&(i+='\nADDITIONAL GUIDANCE: \n- If this is a country selection question and the user is from Germany, select "Deutschland (+49)"\n- Country names may be in German (e.g., "Deutschland" for Germany, "Vereinigte Staaten" for USA)\n- Always choose the option that matches the user\'s country, paying attention to both the name and country code'),i}buildNoOptionsPrompt(n,r,o="",t=""){return"Form Question: ".concat(n," ?\nUser Context Data Hint: ").concat(r,"\nIMPORTANT:\n- Return ONLY the answer as a plain string\n- If the question requires a number, return ONLY a number\n- If the question requires a phone number, return the user's phone ").concat(o,"\n- If the question asks for a salary, use the user's expected salary ").concat(t," or provide a reasonable estimate based on job market data\n- DO NOT add any explanation or additional text\n- Make sure the answer is professional and benefits the user")}},w=new pe;function ze(e){return typeof e>"u"||e===null}function Rn(e){return typeof e=="object"&&e!==null}function Dn(e){return Array.isArray(e)?e:ze(e)?[]:[e]}function Mn(e,n){var r,o,t,a;if(n)for(a=Object.keys(n),r=0,o=a.length;r<o;r+=1)t=a[r],e[t]=n[t];return e}function Un(e,n){var r="",o;for(o=0;o<n;o+=1)r+=e;return r}function Yn(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var qn=ze,Bn=Rn,Jn=Dn,Hn=Un,zn=Yn,Kn=Mn,E={isNothing:qn,isObject:Bn,toArray:Jn,repeat:Hn,isNegativeZero:zn,extend:Kn};function Ke(e,n){var r="",o=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!n&&e.mark.snippet&&(r+="\n\n"+e.mark.snippet),o+" "+r):o}function W(e,n){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=n,this.message=Ke(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}W.prototype=Object.create(Error.prototype);W.prototype.constructor=W;W.prototype.toString=function(n){return this.name+": "+Ke(this,n)};var O=W;function he(e,n,r,o,t){var a="",i="",s=Math.floor(t/2)-1;return o-n>s&&(a=" ... ",n=o-s+a.length),r-o>s&&(i=" ...",r=o+s-i.length),{str:a+e.slice(n,r).replace(/\t/g,"\u2192")+i,pos:o-n+a.length}}function ge(e,n){return E.repeat(" ",n-e.length)+e}function Gn(e,n){if(n=Object.create(n||null),!e.buffer)return null;n.maxLength||(n.maxLength=79),typeof n.indent!="number"&&(n.indent=1),typeof n.linesBefore!="number"&&(n.linesBefore=3),typeof n.linesAfter!="number"&&(n.linesAfter=2);for(var r=/\r?\n|\r|\0/g,o=[0],t=[],a,i=-1;a=r.exec(e.buffer);)t.push(a.index),o.push(a.index+a[0].length),e.position<=a.index&&i<0&&(i=o.length-2);i<0&&(i=o.length-1);var s="",l,c,p=Math.min(e.line+n.linesAfter,t.length).toString().length,u=n.maxLength-(n.indent+p+3);for(l=1;l<=n.linesBefore&&!(i-l<0);l++)c=he(e.buffer,o[i-l],t[i-l],e.position-(o[i]-o[i-l]),u),s=E.repeat(" ",n.indent)+ge((e.line-l+1).toString(),p)+" | "+c.str+"\n"+s;for(c=he(e.buffer,o[i],t[i],e.position,u),s+=E.repeat(" ",n.indent)+ge((e.line+1).toString(),p)+" | "+c.str+"\n",s+=E.repeat("-",n.indent+p+3+c.pos)+"^\n",l=1;l<=n.linesAfter&&!(i+l>=t.length);l++)c=he(e.buffer,o[i+l],t[i+l],e.position-(o[i]-o[i+l]),u),s+=E.repeat(" ",n.indent)+ge((e.line+l+1).toString(),p)+" | "+c.str+"\n";return s.replace(/\n$/,"")}var Qn=Gn,Wn=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Vn=["scalar","sequence","mapping"];function Xn(e){var n={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(o){n[String(o)]=r})}),n}function Zn(e,n){if(n=n||{},Object.keys(n).forEach(function(r){if(Wn.indexOf(r)===-1)throw new O('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=n,this.tag=e,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(r){return r},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=Xn(n.styleAliases||null),Vn.indexOf(this.kind)===-1)throw new O('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var L=Zn;function Fe(e,n){var r=[];return e[n].forEach(function(o){var t=r.length;r.forEach(function(a,i){a.tag===o.tag&&a.kind===o.kind&&a.multi===o.multi&&(t=i)}),r[t]=o}),r}function er(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},n,r;function o(t){t.multi?(e.multi[t.kind].push(t),e.multi.fallback.push(t)):e[t.kind][t.tag]=e.fallback[t.tag]=t}for(n=0,r=arguments.length;n<r;n+=1)arguments[n].forEach(o);return e}function ye(e){return this.extend(e)}ye.prototype.extend=function(n){var r=[],o=[];if(n instanceof L)o.push(n);else if(Array.isArray(n))o=o.concat(n);else if(n&&(Array.isArray(n.implicit)||Array.isArray(n.explicit)))n.implicit&&(r=r.concat(n.implicit)),n.explicit&&(o=o.concat(n.explicit));else throw new O("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof L))throw new O("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new O("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new O("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),o.forEach(function(a){if(!(a instanceof L))throw new O("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var t=Object.create(ye.prototype);return t.implicit=(this.implicit||[]).concat(r),t.explicit=(this.explicit||[]).concat(o),t.compiledImplicit=Fe(t,"implicit"),t.compiledExplicit=Fe(t,"explicit"),t.compiledTypeMap=er(t.compiledImplicit,t.compiledExplicit),t};var Ge=ye,Qe=new L("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),We=new L("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),Ve=new L("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),Xe=new Ge({explicit:[Qe,We,Ve]});function nr(e){if(e===null)return!0;var n=e.length;return n===1&&e==="~"||n===4&&(e==="null"||e==="Null"||e==="NULL")}function rr(){return null}function or(e){return e===null}var Ze=new L("tag:yaml.org,2002:null",{kind:"scalar",resolve:nr,construct:rr,predicate:or,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function tr(e){if(e===null)return!1;var n=e.length;return n===4&&(e==="true"||e==="True"||e==="TRUE")||n===5&&(e==="false"||e==="False"||e==="FALSE")}function ir(e){return e==="true"||e==="True"||e==="TRUE"}function ar(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var en=new L("tag:yaml.org,2002:bool",{kind:"scalar",resolve:tr,construct:ir,predicate:ar,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function sr(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function lr(e){return 48<=e&&e<=55}function cr(e){return 48<=e&&e<=57}function ur(e){if(e===null)return!1;var n=e.length,r=0,o=!1,t;if(!n)return!1;if(t=e[r],(t==="-"||t==="+")&&(t=e[++r]),t==="0"){if(r+1===n)return!0;if(t=e[++r],t==="b"){for(r++;r<n;r++)if(t=e[r],t!=="_"){if(t!=="0"&&t!=="1")return!1;o=!0}return o&&t!=="_"}if(t==="x"){for(r++;r<n;r++)if(t=e[r],t!=="_"){if(!sr(e.charCodeAt(r)))return!1;o=!0}return o&&t!=="_"}if(t==="o"){for(r++;r<n;r++)if(t=e[r],t!=="_"){if(!lr(e.charCodeAt(r)))return!1;o=!0}return o&&t!=="_"}}if(t==="_")return!1;for(;r<n;r++)if(t=e[r],t!=="_"){if(!cr(e.charCodeAt(r)))return!1;o=!0}return!(!o||t==="_")}function dr(e){var n=e,r=1,o;if(n.indexOf("_")!==-1&&(n=n.replace(/_/g,"")),o=n[0],(o==="-"||o==="+")&&(o==="-"&&(r=-1),n=n.slice(1),o=n[0]),n==="0")return 0;if(o==="0"){if(n[1]==="b")return r*parseInt(n.slice(2),2);if(n[1]==="x")return r*parseInt(n.slice(2),16);if(n[1]==="o")return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)}function fr(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!E.isNegativeZero(e)}var nn=new L("tag:yaml.org,2002:int",{kind:"scalar",resolve:ur,construct:dr,predicate:fr,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),pr=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function hr(e){return!(e===null||!pr.test(e)||e[e.length-1]==="_")}function gr(e){var n,r;return n=e.replace(/_/g,"").toLowerCase(),r=n[0]==="-"?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),n===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:n===".nan"?NaN:r*parseFloat(n,10)}var mr=/^[-+]?[0-9]+e/;function yr(e,n){var r;if(isNaN(e))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(E.isNegativeZero(e))return"-0.0";return r=e.toString(10),mr.test(r)?r.replace("e",".e"):r}function br(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||E.isNegativeZero(e))}var rn=new L("tag:yaml.org,2002:float",{kind:"scalar",resolve:hr,construct:gr,predicate:br,represent:yr,defaultStyle:"lowercase"}),on=Xe.extend({implicit:[Ze,en,nn,rn]}),tn=on,an=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),sn=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function xr(e){return e===null?!1:an.exec(e)!==null||sn.exec(e)!==null}function wr(e){var n,r,o,t,a,i,s,l=0,c=null,p,u,d;if(n=an.exec(e),n===null&&(n=sn.exec(e)),n===null)throw new Error("Date resolve error");if(r=+n[1],o=+n[2]-1,t=+n[3],!n[4])return new Date(Date.UTC(r,o,t));if(a=+n[4],i=+n[5],s=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(p=+n[10],u=+(n[11]||0),c=(p*60+u)*6e4,n[9]==="-"&&(c=-c)),d=new Date(Date.UTC(r,o,t,a,i,s,l)),c&&d.setTime(d.getTime()-c),d}function Ar(e){return e.toISOString()}var ln=new L("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:xr,construct:wr,instanceOf:Date,represent:Ar});function vr(e){return e==="<<"||e===null}var cn=new L("tag:yaml.org,2002:merge",{kind:"scalar",resolve:vr}),ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function Cr(e){if(e===null)return!1;var n,r,o=0,t=e.length,a=ve;for(r=0;r<t;r++)if(n=a.indexOf(e.charAt(r)),!(n>64)){if(n<0)return!1;o+=6}return o%8===0}function Er(e){var n,r,o=e.replace(/[\r\n=]/g,""),t=o.length,a=ve,i=0,s=[];for(n=0;n<t;n++)n%4===0&&n&&(s.push(i>>16&255),s.push(i>>8&255),s.push(i&255)),i=i<<6|a.indexOf(o.charAt(n));return r=t%4*6,r===0?(s.push(i>>16&255),s.push(i>>8&255),s.push(i&255)):r===18?(s.push(i>>10&255),s.push(i>>2&255)):r===12&&s.push(i>>4&255),new Uint8Array(s)}function Sr(e){var n="",r=0,o,t,a=e.length,i=ve;for(o=0;o<a;o++)o%3===0&&o&&(n+=i[r>>18&63],n+=i[r>>12&63],n+=i[r>>6&63],n+=i[r&63]),r=(r<<8)+e[o];return t=a%3,t===0?(n+=i[r>>18&63],n+=i[r>>12&63],n+=i[r>>6&63],n+=i[r&63]):t===2?(n+=i[r>>10&63],n+=i[r>>4&63],n+=i[r<<2&63],n+=i[64]):t===1&&(n+=i[r>>2&63],n+=i[r<<4&63],n+=i[64],n+=i[64]),n}function Lr(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var un=new L("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Cr,construct:Er,predicate:Lr,represent:Sr}),_r=Object.prototype.hasOwnProperty,kr=Object.prototype.toString;function Or(e){if(e===null)return!0;var n=[],r,o,t,a,i,s=e;for(r=0,o=s.length;r<o;r+=1){if(t=s[r],i=!1,kr.call(t)!=="[object Object]")return!1;for(a in t)if(_r.call(t,a))if(!i)i=!0;else return!1;if(!i)return!1;if(n.indexOf(a)===-1)n.push(a);else return!1}return!0}function Tr(e){return e!==null?e:[]}var dn=new L("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Or,construct:Tr}),Fr=Object.prototype.toString;function Ir(e){if(e===null)return!0;var n,r,o,t,a,i=e;for(a=new Array(i.length),n=0,r=i.length;n<r;n+=1){if(o=i[n],Fr.call(o)!=="[object Object]"||(t=Object.keys(o),t.length!==1))return!1;a[n]=[t[0],o[t[0]]]}return!0}function Nr(e){if(e===null)return[];var n,r,o,t,a,i=e;for(a=new Array(i.length),n=0,r=i.length;n<r;n+=1)o=i[n],t=Object.keys(o),a[n]=[t[0],o[t[0]]];return a}var fn=new L("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Ir,construct:Nr}),$r=Object.prototype.hasOwnProperty;function jr(e){if(e===null)return!0;var n,r=e;for(n in r)if($r.call(r,n)&&r[n]!==null)return!1;return!0}function Pr(e){return e!==null?e:{}}var pn=new L("tag:yaml.org,2002:set",{kind:"mapping",resolve:jr,construct:Pr}),Ce=tn.extend({implicit:[ln,cn],explicit:[un,dn,fn,pn]}),D=Object.prototype.hasOwnProperty,ee=1,hn=2,gn=3,ne=4,me=1,Rr=2,Ie=3,Dr=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Mr=/[\x85\u2028\u2029]/,Ur=/[,\[\]\{\}]/,mn=/^(?:!|!!|![a-z\-]+!)$/i,yn=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Ne(e){return Object.prototype.toString.call(e)}function I(e){return e===10||e===13}function Y(e){return e===9||e===32}function T(e){return e===9||e===32||e===10||e===13}function B(e){return e===44||e===91||e===93||e===123||e===125}function Yr(e){var n;return 48<=e&&e<=57?e-48:(n=e|32,97<=n&&n<=102?n-97+10:-1)}function qr(e){return e===120?2:e===117?4:e===85?8:0}function Br(e){return 48<=e&&e<=57?e-48:-1}function $e(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?"\n":e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"\x85":e===95?"\xA0":e===76?"\u2028":e===80?"\u2029":""}function Jr(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var bn=new Array(256),xn=new Array(256);for(U=0;U<256;U++)bn[U]=$e(U)?1:0,xn[U]=$e(U);var U;function Hr(e,n){this.input=e,this.filename=n.filename||null,this.schema=n.schema||Ce,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function wn(e,n){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=Qn(r),new O(n,r)}function m(e,n){throw wn(e,n)}function re(e,n){e.onWarning&&e.onWarning.call(null,wn(e,n))}var je={YAML:function(n,r,o){var t,a,i;n.version!==null&&m(n,"duplication of %YAML directive"),o.length!==1&&m(n,"YAML directive accepts exactly one argument"),t=/^([0-9]+)\.([0-9]+)$/.exec(o[0]),t===null&&m(n,"ill-formed argument of the YAML directive"),a=parseInt(t[1],10),i=parseInt(t[2],10),a!==1&&m(n,"unacceptable YAML version of the document"),n.version=o[0],n.checkLineBreaks=i<2,i!==1&&i!==2&&re(n,"unsupported YAML version of the document")},TAG:function(n,r,o){var t,a;o.length!==2&&m(n,"TAG directive accepts exactly two arguments"),t=o[0],a=o[1],mn.test(t)||m(n,"ill-formed tag handle (first argument) of the TAG directive"),D.call(n.tagMap,t)&&m(n,'there is a previously declared suffix for "'+t+'" tag handle'),yn.test(a)||m(n,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch(i){m(n,"tag prefix is malformed: "+a)}n.tagMap[t]=a}};function R(e,n,r,o){var t,a,i,s;if(n<r){if(s=e.input.slice(n,r),o)for(t=0,a=s.length;t<a;t+=1)i=s.charCodeAt(t),i===9||32<=i&&i<=1114111||m(e,"expected valid JSON character");else Dr.test(s)&&m(e,"the stream contains non-printable characters");e.result+=s}}function Pe(e,n,r,o){var t,a,i,s;for(E.isObject(r)||m(e,"cannot merge mappings; the provided source object is unacceptable"),t=Object.keys(r),i=0,s=t.length;i<s;i+=1)a=t[i],D.call(n,a)||(n[a]=r[a],o[a]=!0)}function J(e,n,r,o,t,a,i,s,l){var c,p;if(Array.isArray(t))for(t=Array.prototype.slice.call(t),c=0,p=t.length;c<p;c+=1)Array.isArray(t[c])&&m(e,"nested arrays are not supported inside keys"),typeof t=="object"&&Ne(t[c])==="[object Object]"&&(t[c]="[object Object]");if(typeof t=="object"&&Ne(t)==="[object Object]"&&(t="[object Object]"),t=String(t),n===null&&(n={}),o==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(c=0,p=a.length;c<p;c+=1)Pe(e,n,a[c],r);else Pe(e,n,a,r);else!e.json&&!D.call(r,t)&&D.call(n,t)&&(e.line=i||e.line,e.lineStart=s||e.lineStart,e.position=l||e.position,m(e,"duplicated mapping key")),t==="__proto__"?Object.defineProperty(n,t,{configurable:!0,enumerable:!0,writable:!0,value:a}):n[t]=a,delete r[t];return n}function Ee(e){var n;n=e.input.charCodeAt(e.position),n===10?e.position++:n===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):m(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function C(e,n,r){for(var o=0,t=e.input.charCodeAt(e.position);t!==0;){for(;Y(t);)t===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),t=e.input.charCodeAt(++e.position);if(n&&t===35)do t=e.input.charCodeAt(++e.position);while(t!==10&&t!==13&&t!==0);if(I(t))for(Ee(e),t=e.input.charCodeAt(e.position),o++,e.lineIndent=0;t===32;)e.lineIndent++,t=e.input.charCodeAt(++e.position);else break}return r!==-1&&o!==0&&e.lineIndent<r&&re(e,"deficient indentation"),o}function ie(e){var n=e.position,r;return r=e.input.charCodeAt(n),!!((r===45||r===46)&&r===e.input.charCodeAt(n+1)&&r===e.input.charCodeAt(n+2)&&(n+=3,r=e.input.charCodeAt(n),r===0||T(r)))}function Se(e,n){n===1?e.result+=" ":n>1&&(e.result+=E.repeat("\n",n-1))}function zr(e,n,r){var o,t,a,i,s,l,c,p,u=e.kind,d=e.result,h;if(h=e.input.charCodeAt(e.position),T(h)||B(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(t=e.input.charCodeAt(e.position+1),T(t)||r&&B(t)))return!1;for(e.kind="scalar",e.result="",a=i=e.position,s=!1;h!==0;){if(h===58){if(t=e.input.charCodeAt(e.position+1),T(t)||r&&B(t))break}else if(h===35){if(o=e.input.charCodeAt(e.position-1),T(o))break}else{if(e.position===e.lineStart&&ie(e)||r&&B(h))break;if(I(h))if(l=e.line,c=e.lineStart,p=e.lineIndent,C(e,!1,-1),e.lineIndent>=n){s=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=i,e.line=l,e.lineStart=c,e.lineIndent=p;break}}s&&(R(e,a,i,!1),Se(e,e.line-l),a=i=e.position,s=!1),Y(h)||(i=e.position+1),h=e.input.charCodeAt(++e.position)}return R(e,a,i,!1),e.result?!0:(e.kind=u,e.result=d,!1)}function Kr(e,n){var r,o,t;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,o=t=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(R(e,o,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)o=e.position,e.position++,t=e.position;else return!0;else I(r)?(R(e,o,t,!0),Se(e,C(e,!1,n)),o=t=e.position):e.position===e.lineStart&&ie(e)?m(e,"unexpected end of the document within a single quoted scalar"):(e.position++,t=e.position);m(e,"unexpected end of the stream within a single quoted scalar")}function Gr(e,n){var r,o,t,a,i,s;if(s=e.input.charCodeAt(e.position),s!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=o=e.position;(s=e.input.charCodeAt(e.position))!==0;){if(s===34)return R(e,r,e.position,!0),e.position++,!0;if(s===92){if(R(e,r,e.position,!0),s=e.input.charCodeAt(++e.position),I(s))C(e,!1,n);else if(s<256&&bn[s])e.result+=xn[s],e.position++;else if((i=qr(s))>0){for(t=i,a=0;t>0;t--)s=e.input.charCodeAt(++e.position),(i=Yr(s))>=0?a=(a<<4)+i:m(e,"expected hexadecimal character");e.result+=Jr(a),e.position++}else m(e,"unknown escape sequence");r=o=e.position}else I(s)?(R(e,r,o,!0),Se(e,C(e,!1,n)),r=o=e.position):e.position===e.lineStart&&ie(e)?m(e,"unexpected end of the document within a double quoted scalar"):(e.position++,o=e.position)}m(e,"unexpected end of the stream within a double quoted scalar")}function Qr(e,n){var r=!0,o,t,a,i=e.tag,s,l=e.anchor,c,p,u,d,h,g=Object.create(null),f,y,x,b;if(b=e.input.charCodeAt(e.position),b===91)p=93,h=!1,s=[];else if(b===123)p=125,h=!0,s={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),b=e.input.charCodeAt(++e.position);b!==0;){if(C(e,!0,n),b=e.input.charCodeAt(e.position),b===p)return e.position++,e.tag=i,e.anchor=l,e.kind=h?"mapping":"sequence",e.result=s,!0;r?b===44&&m(e,"expected the node content, but found ','"):m(e,"missed comma between flow collection entries"),y=f=x=null,u=d=!1,b===63&&(c=e.input.charCodeAt(e.position+1),T(c)&&(u=d=!0,e.position++,C(e,!0,n))),o=e.line,t=e.lineStart,a=e.position,H(e,n,ee,!1,!0),y=e.tag,f=e.result,C(e,!0,n),b=e.input.charCodeAt(e.position),(d||e.line===o)&&b===58&&(u=!0,b=e.input.charCodeAt(++e.position),C(e,!0,n),H(e,n,ee,!1,!0),x=e.result),h?J(e,s,g,y,f,x,o,t,a):u?s.push(J(e,null,g,y,f,x,o,t,a)):s.push(f),C(e,!0,n),b=e.input.charCodeAt(e.position),b===44?(r=!0,b=e.input.charCodeAt(++e.position)):r=!1}m(e,"unexpected end of the stream within a flow collection")}function Wr(e,n){var r,o,t=me,a=!1,i=!1,s=n,l=0,c=!1,p,u;if(u=e.input.charCodeAt(e.position),u===124)o=!1;else if(u===62)o=!0;else return!1;for(e.kind="scalar",e.result="";u!==0;)if(u=e.input.charCodeAt(++e.position),u===43||u===45)me===t?t=u===43?Ie:Rr:m(e,"repeat of a chomping mode identifier");else if((p=Br(u))>=0)p===0?m(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):i?m(e,"repeat of an indentation width identifier"):(s=n+p-1,i=!0);else break;if(Y(u)){do u=e.input.charCodeAt(++e.position);while(Y(u));if(u===35)do u=e.input.charCodeAt(++e.position);while(!I(u)&&u!==0)}for(;u!==0;){for(Ee(e),e.lineIndent=0,u=e.input.charCodeAt(e.position);(!i||e.lineIndent<s)&&u===32;)e.lineIndent++,u=e.input.charCodeAt(++e.position);if(!i&&e.lineIndent>s&&(s=e.lineIndent),I(u)){l++;continue}if(e.lineIndent<s){t===Ie?e.result+=E.repeat("\n",a?1+l:l):t===me&&a&&(e.result+="\n");break}for(o?Y(u)?(c=!0,e.result+=E.repeat("\n",a?1+l:l)):c?(c=!1,e.result+=E.repeat("\n",l+1)):l===0?a&&(e.result+=" "):e.result+=E.repeat("\n",l):e.result+=E.repeat("\n",a?1+l:l),a=!0,i=!0,l=0,r=e.position;!I(u)&&u!==0;)u=e.input.charCodeAt(++e.position);R(e,r,e.position,!1)}return!0}function Re(e,n){var r,o=e.tag,t=e.anchor,a=[],i,s=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,m(e,"tab characters must not be used in indentation")),!(l!==45||(i=e.input.charCodeAt(e.position+1),!T(i))));){if(s=!0,e.position++,C(e,!0,-1)&&e.lineIndent<=n){a.push(null),l=e.input.charCodeAt(e.position);continue}if(r=e.line,H(e,n,gn,!1,!0),a.push(e.result),C(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>n)&&l!==0)m(e,"bad indentation of a sequence entry");else if(e.lineIndent<n)break}return s?(e.tag=o,e.anchor=t,e.kind="sequence",e.result=a,!0):!1}function Vr(e,n,r){var o,t,a,i,s,l,c=e.tag,p=e.anchor,u={},d=Object.create(null),h=null,g=null,f=null,y=!1,x=!1,b;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=u),b=e.input.charCodeAt(e.position);b!==0;){if(!y&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,m(e,"tab characters must not be used in indentation")),o=e.input.charCodeAt(e.position+1),a=e.line,(b===63||b===58)&&T(o))b===63?(y&&(J(e,u,d,h,g,null,i,s,l),h=g=f=null),x=!0,y=!0,t=!0):y?(y=!1,t=!0):m(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,b=o;else{if(i=e.line,s=e.lineStart,l=e.position,!H(e,r,hn,!1,!0))break;if(e.line===a){for(b=e.input.charCodeAt(e.position);Y(b);)b=e.input.charCodeAt(++e.position);if(b===58)b=e.input.charCodeAt(++e.position),T(b)||m(e,"a whitespace character is expected after the key-value separator within a block mapping"),y&&(J(e,u,d,h,g,null,i,s,l),h=g=f=null),x=!0,y=!1,t=!1,h=e.tag,g=e.result;else if(x)m(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=p,!0}else if(x)m(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=p,!0}if((e.line===a||e.lineIndent>n)&&(y&&(i=e.line,s=e.lineStart,l=e.position),H(e,n,ne,!0,t)&&(y?g=e.result:f=e.result),y||(J(e,u,d,h,g,f,i,s,l),h=g=f=null),C(e,!0,-1),b=e.input.charCodeAt(e.position)),(e.line===a||e.lineIndent>n)&&b!==0)m(e,"bad indentation of a mapping entry");else if(e.lineIndent<n)break}return y&&J(e,u,d,h,g,null,i,s,l),x&&(e.tag=c,e.anchor=p,e.kind="mapping",e.result=u),x}function Xr(e){var n,r=!1,o=!1,t,a,i;if(i=e.input.charCodeAt(e.position),i!==33)return!1;if(e.tag!==null&&m(e,"duplication of a tag property"),i=e.input.charCodeAt(++e.position),i===60?(r=!0,i=e.input.charCodeAt(++e.position)):i===33?(o=!0,t="!!",i=e.input.charCodeAt(++e.position)):t="!",n=e.position,r){do i=e.input.charCodeAt(++e.position);while(i!==0&&i!==62);e.position<e.length?(a=e.input.slice(n,e.position),i=e.input.charCodeAt(++e.position)):m(e,"unexpected end of the stream within a verbatim tag")}else{for(;i!==0&&!T(i);)i===33&&(o?m(e,"tag suffix cannot contain exclamation marks"):(t=e.input.slice(n-1,e.position+1),mn.test(t)||m(e,"named tag handle cannot contain such characters"),o=!0,n=e.position+1)),i=e.input.charCodeAt(++e.position);a=e.input.slice(n,e.position),Ur.test(a)&&m(e,"tag suffix cannot contain flow indicator characters")}a&&!yn.test(a)&&m(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch(s){m(e,"tag name is malformed: "+a)}return r?e.tag=a:D.call(e.tagMap,t)?e.tag=e.tagMap[t]+a:t==="!"?e.tag="!"+a:t==="!!"?e.tag="tag:yaml.org,2002:"+a:m(e,'undeclared tag handle "'+t+'"'),!0}function Zr(e){var n,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&m(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),n=e.position;r!==0&&!T(r)&&!B(r);)r=e.input.charCodeAt(++e.position);return e.position===n&&m(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(n,e.position),!0}function eo(e){var n,r,o;if(o=e.input.charCodeAt(e.position),o!==42)return!1;for(o=e.input.charCodeAt(++e.position),n=e.position;o!==0&&!T(o)&&!B(o);)o=e.input.charCodeAt(++e.position);return e.position===n&&m(e,"name of an alias node must contain at least one character"),r=e.input.slice(n,e.position),D.call(e.anchorMap,r)||m(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],C(e,!0,-1),!0}function H(e,n,r,o,t){var a,i,s,l=1,c=!1,p=!1,u,d,h,g,f,y;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=i=s=ne===r||gn===r,o&&C(e,!0,-1)&&(c=!0,e.lineIndent>n?l=1:e.lineIndent===n?l=0:e.lineIndent<n&&(l=-1)),l===1)for(;Xr(e)||Zr(e);)C(e,!0,-1)?(c=!0,s=a,e.lineIndent>n?l=1:e.lineIndent===n?l=0:e.lineIndent<n&&(l=-1)):s=!1;if(s&&(s=c||t),(l===1||ne===r)&&(ee===r||hn===r?f=n:f=n+1,y=e.position-e.lineStart,l===1?s&&(Re(e,y)||Vr(e,y,f))||Qr(e,f)?p=!0:(i&&Wr(e,f)||Kr(e,f)||Gr(e,f)?p=!0:eo(e)?(p=!0,(e.tag!==null||e.anchor!==null)&&m(e,"alias node should not have any properties")):zr(e,f,ee===r)&&(p=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(p=s&&Re(e,y))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&m(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),u=0,d=e.implicitTypes.length;u<d;u+=1)if(g=e.implicitTypes[u],g.resolve(e.result)){e.result=g.construct(e.result),e.tag=g.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(D.call(e.typeMap[e.kind||"fallback"],e.tag))g=e.typeMap[e.kind||"fallback"][e.tag];else for(g=null,h=e.typeMap.multi[e.kind||"fallback"],u=0,d=h.length;u<d;u+=1)if(e.tag.slice(0,h[u].tag.length)===h[u].tag){g=h[u];break}g||m(e,"unknown tag !<"+e.tag+">"),e.result!==null&&g.kind!==e.kind&&m(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+g.kind+'", not "'+e.kind+'"'),g.resolve(e.result,e.tag)?(e.result=g.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):m(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||p}function no(e){var n=e.position,r,o,t,a=!1,i;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(i=e.input.charCodeAt(e.position))!==0&&(C(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||i!==37));){for(a=!0,i=e.input.charCodeAt(++e.position),r=e.position;i!==0&&!T(i);)i=e.input.charCodeAt(++e.position);for(o=e.input.slice(r,e.position),t=[],o.length<1&&m(e,"directive name must not be less than one character in length");i!==0;){for(;Y(i);)i=e.input.charCodeAt(++e.position);if(i===35){do i=e.input.charCodeAt(++e.position);while(i!==0&&!I(i));break}if(I(i))break;for(r=e.position;i!==0&&!T(i);)i=e.input.charCodeAt(++e.position);t.push(e.input.slice(r,e.position))}i!==0&&Ee(e),D.call(je,o)?je[o](e,o,t):re(e,'unknown document directive "'+o+'"')}if(C(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,C(e,!0,-1)):a&&m(e,"directives end mark is expected"),H(e,e.lineIndent-1,ne,!1,!0),C(e,!0,-1),e.checkLineBreaks&&Mr.test(e.input.slice(n,e.position))&&re(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ie(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,C(e,!0,-1));return}if(e.position<e.length-1)m(e,"end of the stream or a document separator is expected");else return}function An(e,n){e=String(e),n=n||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+="\n"),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new Hr(e,n),o=e.indexOf("\0");for(o!==-1&&(r.position=o,m(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)no(r);return r.documents}function ro(e,n,r){n!==null&&typeof n=="object"&&typeof r>"u"&&(r=n,n=null);var o=An(e,r);if(typeof n!="function")return o;for(var t=0,a=o.length;t<a;t+=1)n(o[t])}function oo(e,n){var r=An(e,n);if(r.length!==0){if(r.length===1)return r[0];throw new O("expected a single document in the stream, but found more")}}var to=ro,io=oo,vn={loadAll:to,load:io},Cn=Object.prototype.toString,En=Object.prototype.hasOwnProperty,Le=65279,ao=9,V=10,so=13,lo=32,co=33,uo=34,be=35,fo=37,po=38,ho=39,go=42,Sn=44,mo=45,oe=58,yo=61,bo=62,xo=63,wo=64,Ln=91,_n=93,Ao=96,kn=123,vo=124,On=125,k={};k[0]="\\0";k[7]="\\a";k[8]="\\b";k[9]="\\t";k[10]="\\n";k[11]="\\v";k[12]="\\f";k[13]="\\r";k[27]="\\e";k[34]='\\"';k[92]="\\\\";k[133]="\\N";k[160]="\\_";k[8232]="\\L";k[8233]="\\P";var Co=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],Eo=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function So(e,n){var r,o,t,a,i,s,l;if(n===null)return{};for(r={},o=Object.keys(n),t=0,a=o.length;t<a;t+=1)i=o[t],s=String(n[i]),i.slice(0,2)==="!!"&&(i="tag:yaml.org,2002:"+i.slice(2)),l=e.compiledTypeMap.fallback[i],l&&En.call(l.styleAliases,s)&&(s=l.styleAliases[s]),r[i]=s;return r}function Lo(e){var n,r,o;if(n=e.toString(16).toUpperCase(),e<=255)r="x",o=2;else if(e<=65535)r="u",o=4;else if(e<=4294967295)r="U",o=8;else throw new O("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+E.repeat("0",o-n.length)+n}var _o=1,X=2;function ko(e){this.schema=e.schema||Ce,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=E.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=So(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?X:_o,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function De(e,n){for(var r=E.repeat(" ",n),o=0,t=-1,a="",i,s=e.length;o<s;)t=e.indexOf("\n",o),t===-1?(i=e.slice(o),o=s):(i=e.slice(o,t+1),o=t+1),i.length&&i!=="\n"&&(a+=r),a+=i;return a}function xe(e,n){return"\n"+E.repeat(" ",e.indent*n)}function Oo(e,n){var r,o,t;for(r=0,o=e.implicitTypes.length;r<o;r+=1)if(t=e.implicitTypes[r],t.resolve(n))return!0;return!1}function te(e){return e===lo||e===ao}function Z(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Le||65536<=e&&e<=1114111}function Me(e){return Z(e)&&e!==Le&&e!==so&&e!==V}function Ue(e,n,r){var o=Me(e),t=o&&!te(e);return(r?o:o&&e!==Sn&&e!==Ln&&e!==_n&&e!==kn&&e!==On)&&e!==be&&!(n===oe&&!t)||Me(n)&&!te(n)&&e===be||n===oe&&t}function To(e){return Z(e)&&e!==Le&&!te(e)&&e!==mo&&e!==xo&&e!==oe&&e!==Sn&&e!==Ln&&e!==_n&&e!==kn&&e!==On&&e!==be&&e!==po&&e!==go&&e!==co&&e!==vo&&e!==yo&&e!==bo&&e!==ho&&e!==uo&&e!==fo&&e!==wo&&e!==Ao}function Fo(e){return!te(e)&&e!==oe}function Q(e,n){var r=e.charCodeAt(n),o;return r>=55296&&r<=56319&&n+1<e.length&&(o=e.charCodeAt(n+1),o>=56320&&o<=57343)?(r-55296)*1024+o-56320+65536:r}function Tn(e){var n=/^\n* /;return n.test(e)}var Fn=1,we=2,In=3,Nn=4,q=5;function Io(e,n,r,o,t,a,i,s){var l,c=0,p=null,u=!1,d=!1,h=o!==-1,g=-1,f=To(Q(e,0))&&Fo(Q(e,e.length-1));if(n||i)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=Q(e,l),!Z(c))return q;f=f&&Ue(c,p,s),p=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=Q(e,l),c===V)u=!0,h&&(d=d||l-g-1>o&&e[g+1]!==" ",g=l);else if(!Z(c))return q;f=f&&Ue(c,p,s),p=c}d=d||h&&l-g-1>o&&e[g+1]!==" "}return!u&&!d?f&&!i&&!t(e)?Fn:a===X?q:we:r>9&&Tn(e)?q:i?a===X?q:we:d?Nn:In}function No(e,n,r,o,t){e.dump=function(){if(n.length===0)return e.quotingType===X?'""':"''";if(!e.noCompatMode&&(Co.indexOf(n)!==-1||Eo.test(n)))return e.quotingType===X?'"'+n+'"':"'"+n+"'";var a=e.indent*Math.max(1,r),i=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-a),s=o||e.flowLevel>-1&&r>=e.flowLevel;function l(c){return Oo(e,c)}switch(Io(n,s,e.indent,i,l,e.quotingType,e.forceQuotes&&!o,t)){case Fn:return n;case we:return"'"+n.replace(/'/g,"''")+"'";case In:return"|"+Ye(n,e.indent)+qe(De(n,a));case Nn:return">"+Ye(n,e.indent)+qe(De($o(n,i),a));case q:return'"'+jo(n)+'"';default:throw new O("impossible error: invalid scalar style")}}()}function Ye(e,n){var r=Tn(e)?String(n):"",o=e[e.length-1]==="\n",t=o&&(e[e.length-2]==="\n"||e==="\n"),a=t?"+":o?"":"-";return r+a+"\n"}function qe(e){return e[e.length-1]==="\n"?e.slice(0,-1):e}function $o(e,n){for(var r=/(\n+)([^\n]*)/g,o=function(){var c=e.indexOf("\n");return c=c!==-1?c:e.length,r.lastIndex=c,Be(e.slice(0,c),n)}(),t=e[0]==="\n"||e[0]===" ",a,i;i=r.exec(e);){var s=i[1],l=i[2];a=l[0]===" ",o+=s+(!t&&!a&&l!==""?"\n":"")+Be(l,n),t=a}return o}function Be(e,n){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,o,t=0,a,i=0,s=0,l="";o=r.exec(e);)s=o.index,s-t>n&&(a=i>t?i:s,l+="\n"+e.slice(t,a),t=a+1),i=s;return l+="\n",e.length-t>n&&i>t?l+=e.slice(t,i)+"\n"+e.slice(i+1):l+=e.slice(t),l.slice(1)}function jo(e){for(var n="",r=0,o,t=0;t<e.length;r>=65536?t+=2:t++)r=Q(e,t),o=k[r],!o&&Z(r)?(n+=e[t],r>=65536&&(n+=e[t+1])):n+=o||Lo(r);return n}function Po(e,n,r){var o="",t=e.tag,a,i,s;for(a=0,i=r.length;a<i;a+=1)s=r[a],e.replacer&&(s=e.replacer.call(r,String(a),s)),($(e,n,s,!1,!1)||typeof s>"u"&&$(e,n,null,!1,!1))&&(o!==""&&(o+=","+(e.condenseFlow?"":" ")),o+=e.dump);e.tag=t,e.dump="["+o+"]"}function Je(e,n,r,o){var t="",a=e.tag,i,s,l;for(i=0,s=r.length;i<s;i+=1)l=r[i],e.replacer&&(l=e.replacer.call(r,String(i),l)),($(e,n+1,l,!0,!0,!1,!0)||typeof l>"u"&&$(e,n+1,null,!0,!0,!1,!0))&&((!o||t!=="")&&(t+=xe(e,n)),e.dump&&V===e.dump.charCodeAt(0)?t+="-":t+="- ",t+=e.dump);e.tag=a,e.dump=t||"[]"}function Ro(e,n,r){var o="",t=e.tag,a=Object.keys(r),i,s,l,c,p;for(i=0,s=a.length;i<s;i+=1)p="",o!==""&&(p+=", "),e.condenseFlow&&(p+='"'),l=a[i],c=r[l],e.replacer&&(c=e.replacer.call(r,l,c)),$(e,n,l,!1,!1)&&(e.dump.length>1024&&(p+="? "),p+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),$(e,n,c,!1,!1)&&(p+=e.dump,o+=p));e.tag=t,e.dump="{"+o+"}"}function Do(e,n,r,o){var t="",a=e.tag,i=Object.keys(r),s,l,c,p,u,d;if(e.sortKeys===!0)i.sort();else if(typeof e.sortKeys=="function")i.sort(e.sortKeys);else if(e.sortKeys)throw new O("sortKeys must be a boolean or a function");for(s=0,l=i.length;s<l;s+=1)d="",(!o||t!=="")&&(d+=xe(e,n)),c=i[s],p=r[c],e.replacer&&(p=e.replacer.call(r,c,p)),$(e,n+1,c,!0,!0,!0)&&(u=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,u&&(e.dump&&V===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,u&&(d+=xe(e,n)),$(e,n+1,p,!0,u)&&(e.dump&&V===e.dump.charCodeAt(0)?d+=":":d+=": ",d+=e.dump,t+=d));e.tag=a,e.dump=t||"{}"}function He(e,n,r){var o,t,a,i,s,l;for(t=r?e.explicitTypes:e.implicitTypes,a=0,i=t.length;a<i;a+=1)if(s=t[a],(s.instanceOf||s.predicate)&&(!s.instanceOf||typeof n=="object"&&n instanceof s.instanceOf)&&(!s.predicate||s.predicate(n))){if(r?s.multi&&s.representName?e.tag=s.representName(n):e.tag=s.tag:e.tag="?",s.represent){if(l=e.styleMap[s.tag]||s.defaultStyle,Cn.call(s.represent)==="[object Function]")o=s.represent(n,l);else if(En.call(s.represent,l))o=s.represent[l](n,l);else throw new O("!<"+s.tag+'> tag resolver accepts not "'+l+'" style');e.dump=o}return!0}return!1}function $(e,n,r,o,t,a,i){e.tag=null,e.dump=r,He(e,r,!1)||He(e,r,!0);var s=Cn.call(e.dump),l=o,c;o&&(o=e.flowLevel<0||e.flowLevel>n);var p=s==="[object Object]"||s==="[object Array]",u,d;if(p&&(u=e.duplicates.indexOf(r),d=u!==-1),(e.tag!==null&&e.tag!=="?"||d||e.indent!==2&&n>0)&&(t=!1),d&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(p&&d&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),s==="[object Object]")o&&Object.keys(e.dump).length!==0?(Do(e,n,e.dump,t),d&&(e.dump="&ref_"+u+e.dump)):(Ro(e,n,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else if(s==="[object Array]")o&&e.dump.length!==0?(e.noArrayIndent&&!i&&n>0?Je(e,n-1,e.dump,t):Je(e,n,e.dump,t),d&&(e.dump="&ref_"+u+e.dump)):(Po(e,n,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else if(s==="[object String]")e.tag!=="?"&&No(e,e.dump,n,a,l);else{if(s==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new O("unacceptable kind of an object to dump "+s)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}function Mo(e,n){var r=[],o=[],t,a;for(Ae(e,r,o),t=0,a=o.length;t<a;t+=1)n.duplicates.push(r[o[t]]);n.usedDuplicates=new Array(a)}function Ae(e,n,r){var o,t,a;if(e!==null&&typeof e=="object")if(t=n.indexOf(e),t!==-1)r.indexOf(t)===-1&&r.push(t);else if(n.push(e),Array.isArray(e))for(t=0,a=e.length;t<a;t+=1)Ae(e[t],n,r);else for(o=Object.keys(e),t=0,a=o.length;t<a;t+=1)Ae(e[o[t]],n,r)}function Uo(e,n){n=n||{};var r=new ko(n);r.noRefs||Mo(e,r);var o=e;return r.replacer&&(o=r.replacer.call({"":o},"",o)),$(r,0,o,!0,!0)?r.dump+"\n":""}var Yo=Uo,qo={dump:Yo};function _e(e,n){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var Bo=L,Jo=Ge,Ho=Xe,zo=on,Ko=tn,Go=Ce,Qo=vn.load,Wo=vn.loadAll,Vo=qo.dump,Xo=O,Zo={binary:un,float:rn,map:Ve,null:Ze,pairs:fn,set:pn,timestamp:ln,bool:en,int:nn,merge:cn,omap:dn,seq:We,str:Qe},et=_e("safeLoad","load"),nt=_e("safeLoadAll","loadAll"),rt=_e("safeDump","dump"),ot={Type:Bo,Schema:Jo,FAILSAFE_SCHEMA:Ho,JSON_SCHEMA:zo,CORE_SCHEMA:Ko,DEFAULT_SCHEMA:Go,load:Qo,loadAll:Wo,dump:Vo,YAMLException:Xo,types:Zo,safeLoad:et,safeLoadAll:nt,safeDump:rt},$n=ot;var ke=class{constructor(){}parseUserContext(n){try{if(!n)return null;let r=$n.load(n);return console.log("YAML parsed successfully"),r}catch(r){return console.error("Error parsing YAML:",r),null}}countFields(n){let r=0,o=t=>{for(let[a,i]of Object.entries(t))typeof i=="object"&&i!==null&&!Array.isArray(i)?o(i):r++};return o(n),r}formatValueForEmbedding(n,r=""){if(n==null)return"";let o=r.toLowerCase();return o.includes("salary")||o.includes("compensation")?"Salary: ".concat(n,", Expected salary: ").concat(n,", Desired compensation: ").concat(n,", Annual salary: ").concat(n):o.includes("phone")?"Phone number: ".concat(n,", Contact number: ").concat(n,", Tel: ").concat(n):o.includes("visa")?"Visa required: ".concat(n,", Visa status: ").concat(n,", Work permit: ").concat(n):Array.isArray(n)?n.map(t=>this.formatValueForEmbedding(t)).join(", "):typeof n=="object"?Object.entries(n).map(([t,a])=>{if(t.startsWith("_")||a===null||a===void 0)return null;let i=this.formatValueForEmbedding(a,t);return i?"".concat(t,": ").concat(i):null}).filter(Boolean).join(", "):String(n)}async processUserContext(n,r=null){try{if(!n)return console.error("No YAML content provided"),{success:!1,error:"No YAML content provided"};let o=this.parseUserContext(n);if(!o)return console.error("Failed to parse YAML content"),{success:!1,error:"Failed to parse YAML content"};console.log("User context parsed successfully, processing fields for embeddings");let t=new TextEncoder().encode(n).length;console.log("YAML content size: ".concat(t," bytes (").concat((t/1024).toFixed(2)," KB)"));let a=this.countFields(o),i=0;console.log("Total fields to process: ".concat(a));let s=[];for(let[g,f]of Object.entries(o))if(typeof f=="object"&&f!==null&&!Array.isArray(f)){for(let[y,x]of Object.entries(f)){let b="".concat(g,".").concat(y),_=this.formatValueForEmbedding(x,y);s.push({key:b,value:_})}if(g==="personal_information"){if(f.salary&&s.push({key:"salary_information",value:"Expected salary: ".concat(f.salary,", Desired compensation: ").concat(f.salary,", Annual salary expectation: ").concat(f.salary,", Salary requirement: ").concat(f.salary,", Compensation expectation: ").concat(f.salary)}),f.phone){let y=f.phone_prefix||"";s.push({key:"contact_information",value:"Phone number: ".concat(y).concat(f.phone,", Email: ").concat(f.email||"",", Contact details: ").concat(y).concat(f.phone," and ").concat(f.email||"")})}(f.country||f.city)&&s.push({key:"location_information",value:"Located in ".concat(f.city||"",", ").concat(f.country||"",", Location: ").concat(f.city||"",", ").concat(f.country||"")})}}else{let y=this.formatValueForEmbedding(f,g);s.push({key:g,value:y})}if(console.log("Prepared ".concat(s.length," fields to process for embeddings")),o.experiences&&Array.isArray(o.experiences))try{let g=/(\d{4})\s*-\s*(Present|\d{4})/i,f="";o.experiences.forEach(y=>{y.employment_period&&(f+="".concat(y.position||"Role"," at ").concat(y.company||"Company"," (").concat(y.employment_period,"). "))}),f&&s.push({key:"experience_summary",value:"Professional experience: ".concat(f," Years of experience in software development, engineering, and related fields.")})}catch(g){console.warn("Error creating experience summary:",g)}let l=JSON.stringify(s).length;console.log("Estimated data size before embeddings: ".concat(l," bytes (").concat((l/1024).toFixed(2)," KB)"));let c=l>1e6,p=c?10:s.length;c&&console.log("Using chunking strategy for large dataset (".concat(p," fields per chunk)"));let u=5,d=Math.ceil(s.length/u);if(console.log("Processing embeddings in ".concat(d," batches of ").concat(u)),c)try{await v.clearAllData(),console.log("Cleared existing data before processing chunks")}catch(g){console.warn("Error clearing existing data:",g)}let h=0;for(let g=0;g<d;g++){let f=g*u,y=Math.min((g+1)*u,s.length),x=s.slice(f,y);console.log("Processing batch ".concat(g+1,"/").concat(d," (").concat(x.length," fields)"));let b=x.map(S=>v.addEntry(S.key,S.value)),ae=(await Promise.allSettled(b)).filter(S=>S.status==="rejected"||S.status==="fulfilled"&&!S.value);if(ae.length>0&&console.warn("".concat(ae.length," embeddings failed in batch ").concat(g+1)),i+=x.length,r){let S=Math.round(i/a*100);r({progress:S,message:"Processing batch ".concat(g+1,"/").concat(d," (").concat(i,"/").concat(a," fields)")})}if(c&&(g+1)%Math.ceil(p/u)===0)try{console.log("Saving chunk to storage after batch ".concat(g+1,"...")),await v.saveAllEmbeddings(),console.log("Clearing memory store after saving chunk");let S=Object.keys(v.data).length;v.data={},console.log("Cleared ".concat(S," entries from memory"))}catch(S){if(console.error("Error saving chunk to storage:",S),h++,h>=3)return console.error("Multiple storage errors encountered, aborting processing"),r&&r({progress:0,message:"Error: Storage quota exceeded. Try reducing YAML complexity."}),{success:!1,error:"Storage quota exceeded",details:"The profile is too large to store with embeddings. Try simplifying your profile or using fewer fields."}}g<d-1&&await new Promise(S=>setTimeout(S,100))}console.log("Embedding generation complete, saving to storage...");try{if(Object.keys(v.data).length>0){let f=await v.saveAllEmbeddings();console.log("Save result: ".concat(f?"Success":"Failed"))}else c&&console.log("No final chunk to save (already saved in chunks)");let g=c?await v.getStoredEmbeddingsCount():Object.keys(v.data).length;console.log("Final storage contains ".concat(g," entries"))}catch(g){if(console.error("Error saving embeddings:",g),g&&g.message&&(g.message.includes("quota")||g.message.includes("QUOTA")||g.message.includes("limit")||g.message.includes("space")))return r&&r({progress:0,message:"Error: Storage quota exceeded. Try reducing YAML complexity."}),{success:!1,error:"Storage quota exceeded",details:"The profile is too large to store with embeddings. Try simplifying your profile."}}return r&&r({progress:100,message:"All fields processed"}),{success:!0,data:o}}catch(o){return console.error("Error processing user context:",o),r&&r({progress:0,message:"Error: ".concat(o.message)}),{success:!1,error:o.message}}}},jn=new ke;var Oe=class{constructor(n=null){this.apiEndpoint=n||"http://localhost:11434/api/generate",this.model="qwen2.5:3b",this.job=null,this.user_data=null,this.jobInfo=null}setJob(n){this.job=n,console.log("Job information set:",n);let r=n&&n.currentJob?n.currentJob:null;r?(this.jobInfo={company:r.company||"",title:r.title||"",location:r.location||"",description:r.description||""},console.log("Creating conversation context for ".concat(this.jobInfo.company))):console.log("No job information provided")}async setUserContext(n,r=null){try{let o=await jn.processUserContext(n,r);return o.success&&(this.user_data=o.data),{success:o.success,error:o.error||null}}catch(o){return console.error("Error in setUserContext:",o),r&&r({progress:0,message:"Error: ".concat(o.message)}),{success:!1,error:o.message}}}async answerQuestion(n,r=null){try{return console.log("Answering question:",n),console.log("Options:",r),console.log(this.user_data?"In-memory user data cache: Available":"In-memory user data cache: Not available (will use embedding search from storage)"),r&&Array.isArray(r)&&r.length>0?await this.answerWithOptions(n,r):await this.answerWithNoOptions(n)}catch(o){return console.error("Error in answerQuestion:",o),"Error processing question"}}async answerWithOptions(n,r){var o,t,a,i,s,l;try{if(console.log('Getting an answer for "'.concat(n,'" with options:'),r),!r||!Array.isArray(r)||r.length===0)return console.warn("Options array is empty or invalid, falling back to answerWithNoOptions"),this.answerWithNoOptions(n);if(n.toLowerCase().includes("phone country")||n.toLowerCase().includes("country code")||n.toLowerCase().includes("landesvorwahl")){console.log("Found direct match for contact query");let g=((o=this.user_data)==null?void 0:o.personal_information)||{};if(g.country){let f=g.country,y=null;for(let x of r)if(x.toLowerCase().includes(f.toLowerCase())){y=x;break}if(y)return console.log("Found country match: ".concat(y)),w.addAssistantResponse(y),this.sendConversationUpdate(),y;if(f.toLowerCase().includes("german")||f.toLowerCase().includes("deutsch")){for(let x of r)if(x.toLowerCase().includes("germany")||x.toLowerCase().includes("deutsch")||x.toLowerCase().includes("+49"))return console.log("Found German option: ".concat(x)),w.addAssistantResponse(x),this.sendConversationUpdate(),x}}}console.log("Starting semantic search for relevant information...");let c=await v.search(n,3),p="";c.length>0?(console.log("Found ".concat(c.length," relevant keys:"),c),p=c.map(g=>"".concat(g,": ").concat(v.data[g].text)).join(", ")):(console.log("No relevant information found in profile data. Using generic context."),p="The user has significant experience and qualifications suitable for this question.");let u=((t=this.user_data)==null?void 0:t.personal_information)||{},d=u.phone||"",h=u.salary||"";try{let g=w.buildOptionsPrompt(n,r,p);w.addUserMessage(g);let f=await this.callOllamaAPI({model:this.model,messages:w.getCurrentHistory(),options:{temperature:0},stream:!1}),x=(((i=(a=f==null?void 0:f.message)==null?void 0:a.content)==null?void 0:i.trim())||"").replace(/<think>[\s\S]*?<\/think>/g,"").trim();if(r.includes(x))return console.log('Found exact match in options: "'.concat(x,'"')),w.addAssistantResponse(x),this.sendConversationUpdate(),x;console.log('Answer "'.concat(x,'" not found in options, attempting to refine'));let b=await this.refineOptionSelection(x,r);return this.sendConversationUpdate(),b}catch(g){if(console.error("Ollama API error in answerWithOptions:",g),console.log("[Function] Falling back to direct context match due to API error"),console.log("[Function] AI Answer:",(s=v.data[c[0]])==null?void 0:s.text),c.length>0){let y=((l=v.data[c[0]])==null?void 0:l.text)||"",x=await this.refineOptionSelection(y,r);return this.sendConversationUpdate(),x}let f=r.length>1?r[1]:r[0];return console.log("[Function] Selected fallback option:",f),w.addAssistantResponse(f),this.sendConversationUpdate(),f}}catch(c){console.error("Error in answerWithOptions:",c);let p=r.length>1?r[1]:r[0];return w.addAssistantResponse(p),this.sendConversationUpdate(),p}}async refineOptionSelection(n,r){var o,t;try{console.log('Refining answer: "'.concat(n,'" to match available options'));let a=n.toLowerCase().includes("germany")||n.toLowerCase().includes("deutschland")||n.includes("+49"),i="\nOriginal answer: ".concat(n,"\nAvailable options: ").concat(JSON.stringify(r),'\n\nWhich option from the list above most closely matches "').concat(n,'"?\nYou MUST select EXACTLY one option from the list as written.\nDo not add any explanation. Return only the option text exactly as it appears in the list.\n');(a||r.some(d=>d.includes("(+")&&d.includes(")")))&&(i="\nI need to select a country code from a dropdown list.\nThe user's country is: ".concat(n,"\n\nAvailable options in the dropdown: ").concat(JSON.stringify(r),'\n\nIMPORTANT: Please select the option that matches this country, noting that:\n1. Country names may be in German (e.g., "Deutschland" for Germany)\n2. Options include country codes (e.g., "Deutschland (+49)")\n3. For Germany, you should select "Deutschland (+49)"\n4. You MUST select EXACTLY one option from the list AS WRITTEN\n\nWhich option should I select? Return ONLY the exact text of the option.'));let s=await this.callOllamaAPI({model:this.model,messages:[{role:"system",content:"You are a helpful assistant that selects the most appropriate option from a list."},{role:"user",content:i}],options:{temperature:0},stream:!1}),l=((t=(o=s==null?void 0:s.message)==null?void 0:o.content)==null?void 0:t.trim())||"";if(r.includes(l))return console.log('Successfully refined to "'.concat(l,'"')),w.addAssistantResponse(l),this.sendConversationUpdate(),l;if(a||r.some(d=>d.includes("(+")&&d.includes(")"))){for(let d of r)if(d.toLowerCase().includes("deutsch"))return console.log('Found German option: "'.concat(d,'"')),w.addAssistantResponse(d),this.sendConversationUpdate(),d}console.log('Refined answer "'.concat(l,'" still not in options, using basic matching'));let c=null,p=-1;for(let d of r){let h=d.toLowerCase(),g=n.toLowerCase();if(h.includes(g)||g.includes(h)){let f=Math.min(h.length,g.length)/Math.max(h.length,g.length);f>p&&(p=f,c=d)}}if(c&&p>.2)return console.log('Basic matching found: "'.concat(c,'" with score ').concat(p)),w.addAssistantResponse(c),this.sendConversationUpdate(),c;let u=r.length>1?r[1]:r[0];return console.log('No match found, using fallback: "'.concat(u,'"')),w.addAssistantResponse(u),this.sendConversationUpdate(),u}catch(a){console.error("Error in refineOptionSelection:",a);let i=r.length>1?r[1]:r[0];return w.addAssistantResponse(i),this.sendConversationUpdate(),i}}async answerWithNoOptions(n){var r,o,t,a,i;try{if(console.log('Answering question without options: "'.concat(n,'"')),(r=this.user_data)!=null&&r.personal_information){let d=this.user_data.personal_information;if(n.toLowerCase().includes("email")){let h=d.email||"";if(h)return console.log("Found direct match for email query"),w.addAssistantResponse(h),this.sendConversationUpdate(),h}if(n.toLowerCase().includes("phone")||n.toLowerCase().includes("mobile")||n.toLowerCase().includes("telephone")||n.toLowerCase().includes("telefon")){console.log("Found direct match for contact query");let h=d.phone_prefix?d.phone_prefix.replace("+","")+d.phone:d.phone||"";if(h)return w.addAssistantResponse(h),this.sendConversationUpdate(),h}if(n.toLowerCase().includes("name")&&n.toLowerCase().includes("first")){console.log("Found direct match for first name query");let h=d.name||"";if(h)return w.addAssistantResponse(h),this.sendConversationUpdate(),h}if(n.toLowerCase().includes("name")&&n.toLowerCase().includes("last")){console.log("Found direct match for last name query");let h=d.surname||"";if(h)return w.addAssistantResponse(h),this.sendConversationUpdate(),h}}console.log("Starting semantic search for relevant information...");let s=await v.search(n,3),l="";s.length>0?(console.log("Found ".concat(s.length," relevant keys:"),s),l=s.map(d=>"".concat(d,": ").concat(v.data[d].text)).join(", ")):(console.log("No relevant information found in profile data. Using generic context."),l="The user has significant experience and qualifications suitable for this question.");let c=((o=this.user_data)==null?void 0:o.personal_information)||{},p=c.phone||"",u=c.salary||"";try{let d=w.buildNoOptionsPrompt(n,l,p,u,this.user_data);w.addUserMessage(d);let h=await this.callOllamaAPI({model:this.model,messages:w.getCurrentHistory(),options:{temperature:0},stream:!1}),f=(((a=(t=h==null?void 0:h.message)==null?void 0:t.content)==null?void 0:a.trim())||"").replace(/<think>[\s\S]*?<\/think>/g,"").trim();if(["number","how many","zahl","jahre","years","salary","gehalt","euro","eur"].some(_=>n.toLowerCase().includes(_))){let _=f.match(/\d+(?:\.\d+)?/);_&&(["experience","erfahrung","jahre","years"].some(S=>n.toLowerCase().includes(S))?f=parseFloat(_[0])<1?"1":_[0]:f=_[0])}if(f)return w.addAssistantResponse(f),this.sendConversationUpdate(),f;let b="Information not available";return w.addAssistantResponse(b),this.sendConversationUpdate(),b}catch(d){if(console.error("Ollama API error in answerWithNoOptions:",d),console.log("[Function] Falling back to direct context match due to API error"),s.length>0){let y=((i=v.data[s[0]])==null?void 0:i.text)||"";if(console.log("[Function] AI Answer:",y),["number","how many","zahl","jahre","years","salary","gehalt","euro","eur"].some(_=>n.toLowerCase().includes(_))){let _=y.match(/\d+(?:\.\d+)?/);if(_)return console.log("[Function] Extracted number:",_[0]),w.addAssistantResponse(_[0]),this.sendConversationUpdate(),_[0]}if(y&&y.trim())return w.addAssistantResponse(y),this.sendConversationUpdate(),y}if(["phone","telefon","salary","gehalt","compensation","verg\xFCtung"].some(y=>n.toLowerCase().includes(y))){if(n.toLowerCase().includes("phone")||n.toLowerCase().includes("telefon"))return w.addAssistantResponse(p||"Not provided"),this.sendConversationUpdate(),p||"Not provided";if(n.toLowerCase().includes("salary")||n.toLowerCase().includes("gehalt")||n.toLowerCase().includes("compensation")||n.toLowerCase().includes("verg\xFCtung"))return w.addAssistantResponse(u||"Negotiable"),this.sendConversationUpdate(),u||"Negotiable"}let f="Information not available";return w.addAssistantResponse(f),this.sendConversationUpdate(),f}}catch(s){console.error("Error in answerWithNoOptions:",s);let l="Error generating response";return w.addAssistantResponse(l),this.sendConversationUpdate(),l}}async callOllamaAPI(n){try{return new Promise((r,o)=>{chrome.runtime.sendMessage({action:"callOllama",endpoint:"chat",data:n},t=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message)):t.success===!1?o(new Error(t.error||"Unknown error from Ollama API")):r(t.data)})})}catch(r){throw console.error("Error calling Ollama API:",r),r}}async checkOllamaConnection(){try{return new Promise((n,r)=>{chrome.runtime.sendMessage({action:"testOllama"},o=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):o&&o.success?n(!0):r(new Error((o==null?void 0:o.error)||"Failed to connect to Ollama"))})})}catch(n){throw console.error("Error checking Ollama connection:",n),n}}sendConversationUpdate(){if(!this.jobInfo){console.log("No job info available, skipping conversation update");return}try{let n=w.getCurrentHistory();if(!n||n.length<2){console.log("No meaningful conversation to send");return}console.log("Sending conversation update to background:",{company:this.jobInfo.company,title:this.jobInfo.title,conversationLength:n.length}),chrome.runtime.sendMessage({action:"CONVERSATION_UPDATED",data:{company:this.jobInfo.company,title:this.jobInfo.title,conversation:n}});let r=w.getSavedConversations(this.jobInfo.title);if(r&&r.length>0){console.log("Sending ".concat(r.length," saved conversations"));for(let o of r)chrome.runtime.sendMessage({action:"CONVERSATION_UPDATED",data:{company:this.jobInfo.company,title:this.jobInfo.title,conversation:o}})}}catch(n){console.error("Error sending conversation update:",n)}}finalizeConversation(){this.jobInfo&&w.finalizeAndSaveConversation(this.jobInfo)}},z=Oe;var Te=class extends N{static async closeForm(n=!1){var r,o;try{let t=document.querySelector('button[aria-label="Dismiss"]');if(t||(t=document.querySelector('button[aria-label="Close"]')||document.querySelector('button[aria-label="Cancel"]')||document.querySelector("button[data-test-modal-close-btn]")),t){if(t.click(),await this.wait(),n){let a=document.querySelector('button[data-control-name="save_application_btn"]');a&&(a.click(),this.debugLog("Closed form and saved application"))}else{let a=document.querySelector('button[data-control-name="discard_application_confirm_btn"]')||document.querySelector("button[data-test-dialog-secondary-btn]");a&&(a.click(),this.debugLog("Closed form and discarded application"))}await this.wait()}}catch(t){this.errorLog("Error closing form",t);try{let a=document.querySelectorAll("button");for(let i of a)(i.textContent.toLowerCase().includes("close")||i.textContent.toLowerCase().includes("cancel")||(r=i.getAttribute("aria-label"))!=null&&r.toLowerCase().includes("close")||(o=i.getAttribute("aria-label"))!=null&&o.toLowerCase().includes("dismiss"))&&(i.click(),await this.wait(500))}catch(a){this.errorLog("Failed final attempt to close form",a)}}}static async clickNextPage(){try{await this.wait();let n=document.querySelector('button[aria-label="Continue to next step"]');n&&(n.click(),this.debugLog("Clicked on next page button"))}catch(n){this.errorLog("Error clicking on next page button",n)}}static async clickPreviousPage(){try{await this.wait();let n=document.querySelector('button[aria-label="Back to previous step"]');n&&(n.click(),this.debugLog("Clicked on previous page button"))}catch(n){this.errorLog("Error clicking on previous page button",n)}}static async clickReviewApplication(){try{await this.wait();let n=document.querySelector('button[aria-label="Review your application"]');n&&(n.click(),this.debugLog("Clicked on review button"))}catch(n){this.errorLog("Error clicking on review button",n)}}static async clickSubmitApplication(){try{await this.wait();let n=document.querySelector('button[aria-label="Submit application"]');n&&(n.click(),this.debugLog("Clicked on submit button"))}catch(n){this.errorLog("Error clicking on submit button",n)}}static async clickDoneAfterSubmit(){try{await this.wait();let n=document.querySelector('button[aria-label="Done"]');if(!n){let r=document.querySelectorAll("button.artdeco-button");for(let o of r){let t=o.querySelector("span.artdeco-button__text");if(t&&t.textContent.trim()==="Done"){n=o;break}}}n?(n.click(),this.debugLog("Clicked on Done button")):this.debugLog("Done button not found")}catch(n){this.errorLog("Error clicking on Done button",n)}}static async clickDismissAfterSubmit(){try{await this.wait();let n=document.querySelector('button[aria-label="Dismiss"]');if(n||(n=document.querySelector("button[data-test-modal-close-btn]")),!n){let r=document.querySelectorAll("button.artdeco-button--circle.artdeco-modal__dismiss");for(let o of r)if(o.querySelector('svg use[href="#close-medium"]')){n=o;break}}n?(n.click(),this.debugLog("Clicked on Dismiss button")):this.debugLog("Dismiss button not found")}catch(n){this.errorLog("Error clicking on Dismiss button",n)}}static async processForm(n){try{let r=Date.now(),o=3*60*1e3,t=!1,a=new z,i=!1;for(;!t&&Date.now()-r<o;){if(this.debugLog("Starting form processing iteration"),await n())return this.debugLog("Stop requested during form processing"),!1;i?this.debugLog("Skipping redundant form processing for current page"):(await this.processFormQuestions(),i=!0,this.debugLog("Current page form questions processed, will not reprocess"));let s=Date.now(),l=60*1e3,c=!1;for(;!c&&Date.now()-s<l;){if(await n())return this.debugLog("Stop requested during review loop"),!1;if(document.querySelector('button[aria-label="Review your application"]')){if(await this.finalizePageConversation(),await this.clickReviewApplication(),this.debugLog("Found and clicked review button"),c=!0,await this.wait(2e3),document.querySelector('button[aria-label="Submit application"]')){await this.clickSubmitApplication(),this.debugLog("Clicked submit button after review"),t=!0;try{await this.clickDoneAfterSubmit(),await this.clickDismissAfterSubmit()}catch(d){this.errorLog("Error with post-submission actions",d)}break}}else if(document.querySelector('button[aria-label="Continue to next step"]'))await this.finalizePageConversation(),await this.clickNextPage(),this.debugLog("Clicked next page button"),await this.wait(2e3),i=!1;else if(document.querySelector('button[aria-label="Submit application"]')){await this.finalizePageConversation(),await this.clickSubmitApplication(),this.debugLog("Found submit button without review"),t=!0;try{await this.clickDoneAfterSubmit(),await this.clickDismissAfterSubmit()}catch(h){this.errorLog("Error with post-submission actions",h)}break}await this.wait(2e3)}c||this.debugLog("Review button not found within 1 minute, continuing to next iteration"),await this.wait(2e3)}return t?(this.debugLog("Form processed and submitted successfully"),!0):(this.debugLog("Form processing timed out after 3 minutes"),!1)}catch(r){return this.errorLog("Error processing form",r),!1}}static async processFormQuestions(){try{this.debugLog("Processing form questions");let n=document.querySelectorAll("div.fb-dash-form-element");this.debugLog("Found ".concat(n.length," form elements"));for(let r of n)try{let o=r.querySelector("label");if(!o){this.debugLog("No label found for form element");continue}let t=o.textContent.trim();t=t.replace(/(.+?)\1/,"$1"),this.debugLog("Processing question: ".concat(t));let a=r.querySelector("input, textarea, select");if(!a){this.debugLog("No input field found for question");continue}let i=[];switch(a.tagName.toLowerCase()){case"input":a.type==="radio"&&r.querySelectorAll('input[type="radio"]').forEach(l=>{let c=r.querySelector('label[for="'.concat(l.id,'"]'));c&&i.push(c.textContent.trim())});break;case"select":i=Array.from(a.options).map(s=>s.text.trim());break}i.length>0&&this.debugLog('Available options for "'.concat(t,'":')),await this.answerQuestion(t,i,a,r)}catch(o){this.errorLog("Error processing form element: ".concat(o.message),o)}return this.debugLog("Completed processing form questions"),!0}catch(n){return this.errorLog("Error in processFormQuestions",n),!1}}static async answerQuestion(n,r=[],o,t){try{let a=new z;this.debugLog("Answering question: ".concat(n)),this.debugLog("Available options:",r);try{let l=await chrome.storage.local.get("userProfileYaml");l&&l.userProfileYaml?(this.debugLog("Found user profile YAML in storage"),await a.setUserContext(l.userProfileYaml),this.debugLog("Set user context in AI instance")):this.debugLog("No user profile found in storage")}catch(l){this.errorLog("Error loading user profile from storage:",l)}let i=await chrome.storage.local.get("currentJob");a.setJob(i);let s=await a.answerQuestion(n,r);if(!s)return this.debugLog("No answer generated for question"),!1;switch(this.debugLog("AI Answer: ".concat(s)),o.tagName.toLowerCase()){case"input":switch(o.type){case"text":case"tel":case"email":o.value=s,o.dispatchEvent(new Event("input",{bubbles:!0}));break;case"radio":let l=t.querySelectorAll('input[type="radio"]');for(let c of l){let p=t.querySelector('label[for="'.concat(c.id,'"]'));if(p&&p.textContent.trim()===s){c.click(),this.debugLog("Selected radio option: ".concat(s));break}}break;case"checkbox":o.checked=!0,o.dispatchEvent(new Event("change",{bubbles:!0}));break}break;case"textarea":o.value=s,o.dispatchEvent(new Event("input",{bubbles:!0}));break;case"select":for(let l=0;l<o.options.length;l++)if(o.options[l].text.trim()===s){o.selectedIndex=l,o.dispatchEvent(new Event("change",{bubbles:!0})),this.debugLog("Selected option: ".concat(s));break}break}return await this.wait(500),!0}catch(a){return this.errorLog('Error answering question "'.concat(n,'"'),a),!1}}static async finalizePageConversation(){try{let n=new z,r=await chrome.storage.local.get("currentJob");n.setJob(r),n.finalizeConversation(),this.debugLog("Finalized conversation for current page")}catch(n){this.errorLog("Error finalizing page conversation",n)}}},K=Te;function A(e,n=null){let r=new Date().toISOString().split("T")[1],o="[EasyJob Debug ".concat(r,"] ").concat(e);n?console.log(o,n):console.log(o)}function j(e,n="info"){A("Status Update: ".concat(n," - ").concat(e)),chrome.runtime.sendMessage({type:"STATUS_UPDATE",text:e,status:n})}async function P(e){return e?!1:(A("Auto-apply process stopped by user"),j("Auto-apply process stopped","info"),chrome.runtime.sendMessage({type:"PROCESS_COMPLETE"}),!0)}chrome.runtime.onMessage.addListener((e,n,r)=>{if(e.action==="START_AUTO_APPLY")return tt().then(()=>{r({success:!0})}).catch(o=>{console.error("Error in auto-apply process:",o),r({success:!1,error:o.message})}),!0});async function tt(){}var F=!1;async function it(){try{if(A("Starting auto-apply process"),A("Current URL:",window.location.href),await P(F))return;let e=document.querySelector(".scaffold-layout.jobs-search-two-pane__layout");if(A("Search element found:",!!e),!e){A("Available elements on page:",{body:document.body.innerHTML.substring(0,500)+"...",possibleSelectors:{scaffold:document.querySelector(".scaffold-layout"),jobsSearch:document.querySelector(".jobs-search-two-pane__layout"),anyJobsRelated:document.querySelectorAll('[class*="jobs-"]')}}),j("Could not find jobs list. Please make sure you are on LinkedIn jobs page.","error");return}A("Getting total jobs count");let n=await G.getTotalJobsSearchCount(e);A("Total jobs found:",n),j("Found ".concat(n," jobs to process"),"info"),A("Getting available pages");let r=await G.getAvailablePages(e,n);A("Total pages found:",r);for(let o=1;o<=r;o++){if(await P(F))return;A("Processing page ".concat(o,"/").concat(r)),j("Processing page ".concat(o," of ").concat(r),"info");let t=await G.getListOfJobsOnPage(e);A("Found ".concat(t.length," jobs on page ").concat(o));for(let a of t){if(await P(F))return;try{let i=await M.getJobClickableElement(a);if(await M.clickOnJob(i),A("Clicked on job"),await M.scrollDownToLoadNextJob(a),A("Scrolled to job"),await P(F))return;let s=await M.isEasyButtonAvailable();if(A("Is Easy Apply button available:",s),!s){A("Job already applied. Skipping..."),j("Job already applied. Skipping...","info");continue}let l=await de.getAllJobInfo();if(A("Job info:",l),await chrome.storage.local.set({currentJob:l}),await M.clickEasyApply(),A("Attempted to click Easy Apply"),await new Promise(c=>setTimeout(c,2e3)),await P(F)){await K.closeForm(!1);return}await K.processForm(()=>P(F)),A("Processed application form"),await chrome.storage.local.remove("currentJob"),A("Removed current job from storage")}catch(i){console.error("Error processing job:",i),A("Error processing job:",{error:i.message,stack:i.stack}),j("Error processing job. Continuing to next one...","error"),await K.closeForm(!1)}await P(F)||(await new Promise(i=>setTimeout(i,3e3)),A("Waited cooldown period"))}}await P(F)||(A("Auto-apply process completed"),j("Auto-apply process completed!","success"),chrome.runtime.sendMessage({type:"PROCESS_COMPLETE"}))}catch(e){console.error("Error in auto-apply process:",e),A("Fatal error in auto-apply process:",{error:e.message,stack:e.stack}),j("Error in auto-apply process","error"),await K.closeForm(!1)}}chrome.runtime.onMessage.addListener((e,n,r)=>(A("Received message in content script:",e),e.action==="START_AUTO_APPLY"?F||(F=!0,A("Starting auto-apply process"),it()):e.action==="STOP_AUTO_APPLY"?(A("Stopping auto-apply process"),F=!1):e.action==="GET_STATE"&&(A("Getting current state"),r({isRunning:F})),!0));console.log("Initializing EasyJob AI systems...");async function at(){try{console.log("-----------------------------------"),console.log("\u{1F504} EasyJob AI System Initialization"),console.log("-----------------------------------"),console.log("Preloading embeddings into memory..."),await v.preloadEmbeddings();let e=Object.keys(v.data).length,n=await v.getStoredEmbeddingsCount();if(console.log("Memory status:",{memoryStoreSize:e,storageCount:n,hasLoadedFromStorage:v.hasTriedLoading}),e>0){console.log("\u2705 Embeddings successfully loaded into memory");let r=new z;console.log("\u2705 AI question answerer initialized and ready")}else console.log("\u26A0\uFE0F No embeddings found in memory. Checking storage and profile status..."),await new Promise(o=>{chrome.storage.local.get("userProfile",t=>{o(!!t.userProfile)})})?(console.log("\u{1F50D} User profile exists but embeddings are not generated or failed to load."),console.log("\u{1F4A1} Please open the extension popup and reload the profile to generate embeddings."),chrome.storage.local.get(null,function(o){console.log("\u{1F4CA} Storage overview:",{totalItems:Object.keys(o).length,hasProfile:!!o.userProfile,hasEmbeddings:!!o.storedEmbeddings,profileSize:o.userProfile?JSON.stringify(o.userProfile).length:0,embeddingsSize:o.storedEmbeddings?JSON.stringify(o.storedEmbeddings).length:0})})):(console.log("\u274C No user profile found in storage."),console.log("\u{1F4A1} Please upload a profile through the extension popup."));console.log("-----------------------------------")}catch(e){console.error("\u274C Error initializing AI:",e)}}at();
/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/
